

# 大模型关键参数 temperature / top_p / top_k

## 一、参数作用

| 参数 | 作用 | 原理 |
|------|------|------|
| **`temperature`** | 控制输出随机性 | 值越低越确定（≈0.1），越高越随机（>1.0） |
| **`top_k`** | 从概率最高的 k 个 token 中采样 | 固定候选集大小（如 k=50） |
| **`top_p` (nucleus)** | 从累积概率 ≥ p 的最小 token 集中采样 | 动态候选集（如 p=0.9） |

> ✅ 推荐：**优先用 `temperature + top_p`，避免同时用 `top_k` 和 `top_p`**

## 二、典型场景推荐配置

| 场景 | temperature | top_p | 说明 |
|------|-------------|-------|------|
| **事实问答 / 代码生成** | 0.1 ~ 0.3 | 0.8 ~ 0.9 | 高准确，低幻觉 |
| **聊天机器人** | 0.5 ~ 0.8 | 0.9 | 自然流畅，适度有趣 |
| **创意写作 / 故事生成** | 0.7 ~ 1.2 | 0.9 ~ 0.95 | 高多样性，有惊喜 |
| **数据增强** | 1.0 ~ 1.5 | 0.95 ~ 1.0 | 最大化多样性（需后过滤） |

## 三、避坑指南

- ❌ `temperature > 1.2` → 容易胡说、语法错误
- ❌ 默认值（如 temp=1.0）≠ 最优值，需按业务调优
- ✅ `top_p` 比 `top_k` 更智能（自适应候选集）
- ✅ 结合 `max_tokens` 和 `stop` 控制输出长度
