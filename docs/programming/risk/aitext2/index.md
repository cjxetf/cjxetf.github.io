# AI 社交内容风控误杀监控优化

## 一、误杀定义（教育社交场景特化）

> **误杀 ≠ 技术错误，而是“伤害用户体验或教育目标的过度干预”**


| 类型               | 示例                                                         | 是否算误杀        |
| -------------------- | -------------------------------------------------------------- | ------------------- |
| **硬误杀**   | 用户说“我想跳高” → 被判自杀拦截                           | ✅ 是             |
| **软误杀**   | 用户问“怎么缓解焦虑” → 回复“建议联系心理热线”（未共情） | ✅ 是（体验伤害） |
| **合理拦截** | 用户问“割腕用什么刀快” → 拦截                             | ❌ 否             |
| **合理重写** | 用户说“活着好累” → 回复“我能感受到你的痛苦…要聊聊吗？” | ❌ 否             |

> 💡 ​**关键**​：在教育/陪伴场景，**“安全但冷漠”的回复 = 误杀**

---

## 📊 二、误杀评估指标体系（分层设计）

### 🔹 ① 基础指标（必须监控）

| 指标                           | 计算方式                                            | 目标阈值 | 说明                        |
| -------------------------------- | ----------------------------------------------------- | ---------- | ----------------------------- |
| **硬误杀率**             | `人工复判为安全的拦截数 / 总拦截数`             | ≤ 2%    | 需每日抽样 1000+ 样本       |
| **软误杀率（负反馈率）** | `用户点击“回答不对劲”的次数 / 安全重写总次数` | ≤ 5%    | 需埋点“负反馈”按钮        |
| **重写偏离度**           | NLP 模型判断重写内容 vs 用户意图相关性              | ≥ 0.7   | 用 Sentence-BERT 计算相似度 |

> ✅ ​**教育场景特别关注**​：
> 
> * “安慰话术是否匹配用户情绪强度？”
> * “是否回避了合理学习问题？”（如把“如何高效背单词”当成诱导拖延）

---

### 🔹 ② 行为指标（体验影响）


| 指标                     | 监控方式                             | 异常信号       |
| -------------------------- | -------------------------------------- | ---------------- |
| **会话中断率**     | 拦截后用户未继续对话的比例           | ↑ 10%+ 需告警 |
| **次日留存率**     | 被拦截用户 vs 全量用户的次日活跃差值 | ↓ 5%+ 需分析  |
| **任务完成率下降** | K12 场景：被拦截后当日作业完成率     | 显著低于均值   |
| **付费转化流失**   | 成人用户被拦截后取消会员订阅         | 关联归因分析   |

> 💡 ​**技巧**​：用 **PSM（倾向得分匹配）** 对比“被拦截用户”与“相似未拦截用户”的行为差异，排除混杂因素。

---

## 🔍 三、精细化监控：多维拆解误杀根因

所有拦截记录必须打标以下字段，支持下钻分析：



```
{
  "request_id": "req_123",
  "risk_type": "suicide",        // 风险类型
  "stage": "input",              // 阶段：input / stream / output
  "trigger_rules": ["ac_word_jump", "regex_si"], // 命中规则ID
  "risk_score": 0.85,
  "user_intent": "exercise_question", // 真实意图（人工标注）
  "rewrite_template_id": "care_v2",
  "negative_feedback": true
}
```

### 🔧 维度拆解看板（必须支持）


| 维度                 | 分析价值                                                     |
| ---------------------- | -------------------------------------------------------------- |
| **按规则ID**   | 找出高误杀规则（如正则 `.*[跳跳].*[楼高]` 误杀“跳高”） |
| **按风险类型** | 自残类误杀率是否远高于色情类？                               |
| **按阶段**     | 流式拦截是否比输入拦截误杀更高？（因上下文不全）             |
| **按用户群**   | K12 学生 vs 成人考生，误杀模式是否不同？                     |
| **按重写模板** | “心理热线”模板是否负反馈率高？                             |

> 📈 ​**可视化**​：Grafana + ClickHouse 实时看板，支持“规则误杀热力图”

---

## 🛠 四、误杀优化四步法（工程化闭环）

### ✅ 1. 风险分级：避免“一刀切”


| 风险等级                            | 处置策略         | 误杀容忍度 |
| ------------------------------------- | ------------------ | ------------ |
| ​**L1 高危**​（含具体方法） | 立即拦截，无重写 | 0%         |
| ​**L2 中危**​（表达意图）   | 安全重写 + 引导  | ≤ 3%      |
| ​**L3 低危**​（模糊表达）   | 仅记录，不干预   | 可忽略     |

> 💡 ​**实现**​：在输入风控阶段输出 `risk_level`，决定后续动作。

---

### ✅ 2. 组合策略：降低单一规则依赖

* ​**旧做法**​：正则命中 → 拦截
* ​**新做法**​：
  python编辑
  
  ```
  if (ac_hit or regex_hit) and context_risk_score > 0.6:
      trigger_intervention()
  else:
      allow_with_monitoring()
  ```
* ​**上下文增强**​：
  
  * 若前3轮对话是数学题 → “跳楼”更可能是“跳高”误写
  * 若用户历史无负面情绪 → 降低自残风险分

---

### ✅ 3. 高误杀规则专项治理

对 Top 10 误杀规则实施 ​**“一规一策”**​：


| 规则类型               | 优化手段                                                |
| ------------------------ | --------------------------------------------------------- |
| **字面量 AC 词** | 加白名单上下文（如“跳高”“跳绳”）                    |
| **宽泛正则**     | 收紧边界（如要求前后有负面情绪词）                      |
| **小模型误判**   | 重新标注训练数据，加入对抗样本                          |
| **重写模板**     | A/B 测试新话术（如“要聊聊吗？” vs “心理热线：XXX”） |

> 📌 ​**流程**​：
> 误杀规则 → 自动标记 → 运营审核 → 灰度发布 → 效果验证 → 全量/回滚

---

### ✅ 4. 策略灰度 & AB 测试

* ​**灰度维度**​：
  * 用户分层：K12 / 成人 / 新用户 / 老用户
  * 流量比例：5% → 20% → 100%
* ​**AB 指标**​：
  * 实验组：新规则/新重写模板
  * 对照组：旧策略
  * ​**核心观测**​：误杀率 + 会话中断率 + 负反馈率
* ​**熔断机制**​：
  * 若实验组误杀率 ↑ 50% 或 中断率 ↑ 10% → 自动回滚

---

## 🔄 五、数据闭环：从监控到进化

### 🔧 关键工具

* ​**人工复判平台**​：支持快速标注“真实意图”“是否误杀”
* ​**规则仿真器**​：回放历史流量，测试新规则误杀率
* ​**负反馈聚类**​：用 LLM 自动归类用户抱怨（如“太官方”“答非所问”）

---

## ✅ 六、教育场景特别优化项


| 问题                       | 优化方案                                                            |
| ---------------------------- | --------------------------------------------------------------------- |
| **把学习问题当风险** | 在 K12 模式中，对“死记硬背”“压力大”等词降权                     |
| **安慰话术模板化**   | 引入 ​**个性化共情**​：“上次你说函数难，这次又卡住了吗？” |
| **打断解题思路**     | 流式监控中，若检测到“正在讲解步骤” → 暂停风险扫描                |

---

## 💡 总结：误杀治理的核心思想

> **“宁可漏杀一千，不可误伤一人” —— 在教育陪伴场景，信任一旦破坏，极难重建。**

通过：

* ​**精准指标**​（硬+软误杀）
* ​**根因下钻**​（规则/阶段/人群）
* ​**组合策略**​（上下文+风险分）
* ​**灰度闭环**​（AB测试+熔断）

实现 ​**安全与体验的动态平衡**​，让 AI 伙伴既可靠，又“懂你”。
