import{_ as e,I as n,c as l,o as t,j as i,J as p,a9 as k,a as h,bH as r,bI as d,bJ as F,bK as g,bL as o,bM as c,bN as b}from"./chunks/framework.Dp2GimK2.js";const f=JSON.parse('{"title":"安装 Docker & Kubernetes","description":"","frontmatter":{},"headers":[],"relativePath":"programming/build-env/docker-k8s/index.md","filePath":"programming/build-env/docker-k8s/index.md","lastUpdated":1765356475000}'),E={name:"programming/build-env/docker-k8s/index.md"};function y(u,s,m,C,B,_){const a=n("ArticleMetadata");return t(),l("div",null,[s[0]||(s[0]=i("h1",{id:"安装-docker-kubernetes",tabindex:"-1"},[h("安装 Docker & Kubernetes "),i("a",{class:"header-anchor",href:"#安装-docker-kubernetes","aria-label":"Permalink to “安装 Docker & Kubernetes”"},"​")],-1)),p(a),s[1]||(s[1]=k('<h2 id="_1-安装-docker" tabindex="-1">1.安装 Docker <a class="header-anchor" href="#_1-安装-docker" aria-label="Permalink to “1.安装 Docker”">​</a></h2><p>从<a href="https://www.docker.com/" target="_blank" rel="noreferrer">官网</a> 下载并安装 Docker Desktop，它包含了 Docker 引擎和 Docker CLI 工具，安装完成后可以通过命令行使用 Docker。</p><p>打开设置， 修改以下几处：</p><ol><li><p>关闭当 Docker Desktop 启动时自动打开 Dashboard：</p><p><img src="'+r+'" alt="" loading="lazy"></p></li><li><p>修改镜像源为国内源（可选）：</p><p><img src="'+d+'" alt="" loading="lazy"></p><blockquote><p>镜像源可以查看<a href="https://gist.github.com/y0ngb1n/7e8f16af3242c7815e7ca2f0833d3ea6" target="_blank" rel="noreferrer">此仓库</a></p></blockquote></li><li><p>配置资源限制（可选）：</p><p><img src="'+F+`" alt="" loading="lazy"></p><div class="language-plaintext line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">plaintext</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>CPU Limit: 总CPU核数的一半</span></span>
<span class="line"><span>Memory Limit: 总内存的 1/3 ~ 1/2</span></span>
<span class="line"><span>Swap: 1~2 倍内存上限(Memory Limit /2)</span></span>
<span class="line"><span>Disk Image Size: 60~100 GB</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li><li><p>关闭自动更新（可选）：</p><p><img src="`+g+'" alt="" loading="lazy"></p></li><li><p>保存并重启 Docker Desktop。</p></li><li><p>安装常用的中间件镜像，可以访问<a href="https://github.com/yolk23321/docker-compose-collection" target="_blank" rel="noreferrer">此仓库</a></p></li></ol><h2 id="_2-安装-kubernetes" tabindex="-1">2.安装 Kubernetes <a class="header-anchor" href="#_2-安装-kubernetes" aria-label="Permalink to “2.安装 Kubernetes”">​</a></h2><p>Docker Desktop 自带了 Kubernetes 集群，可以直接启用。</p><p><img src="'+o+'" alt="" loading="lazy"></p><p>等待 Kubernetes 启动完成后，可以通过命令行使用 kubectl 工具来管理 Kubernetes 集群。</p><ol><li><p>打开<code>~/.kube/config</code>文件，查看 Kubernetes 集群的配置信息：</p><p><img src="'+c+'" alt="" loading="lazy"></p><blockquote><p><code>docker-desktop</code>是默认的集群名称。如果需要连接其他 Kubernetes 集群，直接同理追加配置即可。</p></blockquote></li><li><p>安装<a href="https://krew.sigs.k8s.io/docs/user-guide/setup/install/" target="_blank" rel="noreferrer">krew</a>，它是 kubectl 的插件管理工具：</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">set</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -x</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;$(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mktemp</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">)&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &amp;&amp;OS</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;$(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">uname</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> tr</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;[:upper:]&#39; &#39;[:lower:]&#39;)&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &amp;&amp;ARCH</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;$(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">uname</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -m</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sed</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -e</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;s/x86_64/amd64/&#39; </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">-e</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;s/\\(arm\\)\\(64\\)\\?.*/\\1\\2/&#39; </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">-e</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;s/aarch64$/arm64/&#39;)&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &amp;&amp;KREW</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;krew-${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">OS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}_${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ARCH</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &amp;&amp;</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">curl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -fsSLO</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;https://github.com/kubernetes-sigs/krew/releases/latest/download/${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">KREW</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}.tar.gz&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &amp;&amp;</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">tar</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> zxvf</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">KREW</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}.tar.gz&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &amp;&amp;</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">./</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">KREW</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">}&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> krew</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>复制到终端执行即可：</p><p><img src="'+b+`" alt="" loading="lazy"></p><p>在<code>~/.zshrc</code>中追加如下内容：</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 顺便加个别名</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">alias</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> k</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">kubectl</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 为别名 k 启用 kubectl 的自动补全功能。__start_kubectl 是 kubectl 自带的补全函数。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">complete</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> default</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -F</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> __start_kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> k</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 检查 kubectl 是否在系统里 ($commands[kubectl] 表示是否能找到命令)。</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[[ $commands[kubectl] ]] &amp;&amp; </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">source</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &lt;(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> completion zsh)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> PATH</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;\${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">KREW_ROOT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$HOME</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">krew</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}/bin:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$PATH</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>保存并执行<code>source ~/.zshrc</code>使配置生效。</p></li><li><p>使用 krew 安装几个插件：</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">k</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> krew</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ctx</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        # 用于快速切换 Kubernetes 上下文</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">k</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> krew</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ns</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">         # 用于快速切换命名空间</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">k</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> krew</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> neat</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">       # 用于清理冗余的 Kubernetes 资源</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">k</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> krew</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tree</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">       # 以树状图形式显示 Kubernetes 资源的层级关系</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><blockquote><p><code>k</code> 是在上一步中为 <code>kubectl</code> 创建的别名。</p></blockquote></li></ol>`,9))])}const A=e(E,[["render",y]]);export{f as __pageData,A as default};
